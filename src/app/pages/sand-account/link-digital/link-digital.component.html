<app-page-header [pageHeaderInfo]="pageHeaderInfo"></app-page-header>
<ng-template #headerExtra>
  <div>
    <div>
      <img src="../../../../assets/images/WEB.png" alt="" />
      <img class="m-l-5" src="../../../../assets/images/API (1).png" alt="" />
    </div>
  </div>
</ng-template>
<ng-template #headerContent>
  <span class="ctx-desc">
    Prior to transacting on UDPN, a user's DID must be linked with their digital
    currency wallet.
  </span>
</ng-template>
<div class="normal-table-wrap">
  <nz-card
    [nzBodyStyle]="{ 'padding-bottom': 0 }"
    [nzTitle]="'Query Accounts'"
    class="m-b-10"
  >
    <form nz-form nzLayout="vertical">
      <div nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24 }">
        <div
          nz-col
          [nzXXl]="8"
          [nzXl]="8"
          [nzLg]="12"
          [nzMd]="12"
          [nzSm]="24"
          [nzXs]="24"
        >
          <nz-form-item>
            <nz-form-label [nzFor]="">DID</nz-form-label>
            <nz-form-control>
              <input
                nz-input
                placeholder=""
                name="did"
                [(ngModel)]="searchParam.did"
              />
            </nz-form-control>
          </nz-form-item>
        </div>
        <div
          nz-col
          [nzXXl]="4"
          [nzXl]="4"
          [nzLg]="6"
          [nzMd]="6"
          [nzSm]="24"
          [nzXs]="24"
        >
          <nz-form-item>
            <nz-form-label [nzNoColon]="true">Currency Type</nz-form-label>
            <nz-form-control>
              <div nz-col [nzSpan]="24">
                <nz-select
                  name="currencyType"
                  [(ngModel)]="searchParam.currencyType"
                  (ngModelChange)="onFiledChange($event)"
                >
                  <nz-option nzValue="" nzLabel="All"></nz-option>
                  <nz-option
                    *ngFor="let items of currencyApiArr"
                    [nzValue]="items.currencyName"
                    [nzLabel]="items.currencyName"
                  >
                    {{ items.currencyName }}
                  </nz-option>
                </nz-select>
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div
          nz-col
          [nzXXl]="4"
          [nzXl]="4"
          [nzLg]="6"
          [nzMd]="6"
          [nzSm]="24"
          [nzXs]="24"
        >
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"></nz-form-label>
            <nz-form-control>
              <div nz-col [nzSpan]="24">
                <nz-select
                  name="platformType"
                  [(ngModel)]="searchParam.platformType"
                >
                  <nz-option nzValue="" nzLabel="All"></nz-option>
                  <nz-option
                    *ngFor="let items of platformList"
                    [nzValue]="items"
                    [nzLabel]="items"
                  >
                    {{ items }}
                  </nz-option>
                </nz-select>
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div
          nz-col
          [nzXXl]="8"
          [nzXl]="8"
          [nzLg]="24"
          [nzMd]="24"
          [nzSm]="24"
          [nzXs]="24"
          class="text-right"
        >
          <nz-form-item>
            <nz-form-label [nzNoColon]="true"></nz-form-label>
            <nz-form-control>
              <div nz-col [nzSpan]="24">
                <button
                  nz-button
                  [nzType]="'primary'"
                  [disabled]="!searchParam.did"
                  (click)="getDataList()"
                >
                  Query
                </button>
                <a nz-button nzType="link" class="m-l-15" (click)="resetForm()"
                  >Reset</a
                >
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col class="m-b-20">
          <span class="operate-text"
            >To search for an account binding, please enter DID and Currency
            Type, then click Query.</span
          >
        </div>
      </div>
    </form>
  </nz-card>

  <app-card-table-wrap
    [tableTitle]="'Binding List'"
    [isNormalTable]="true"
    (reload)="reloadTable()"
    [btnTpl]="tableBtns"
  >
    <app-ant-table
      (selectedChange)="selectedChecked($event)"
      (changePageSize)="changePageSize($event)"
      (sortFn)="changeSort($event)"
      (changePageNum)="getDataList($event)"
      [tableConfig]="tableConfig"
      [tableData]="dataList"
    ></app-ant-table>
    <ng-template
      #currencyAccountTpl
      let-currencyAccount="currencyAccount"
      let-isDefault="isDefault"
    >
      <span>
        {{ currencyAccount }}
        <span [ngStyle]="{ color: 'red' }">{{
          isDefault === 1 ? '(Default Binding Account)' : ''
        }}</span>
      </span>
    </ng-template>
    <ng-template #operationTpl let-accountBindingId="accountBindingId">
      <span class="operate-text" (click)="unbind(accountBindingId)"
        >Unbind</span
      >
      <nz-divider nzType="vertical"></nz-divider>
      <span class="operate-text" (click)="isDefault(accountBindingId)"
        >Set as Default Account</span
      >
    </ng-template>
  </app-card-table-wrap>
</div>
<ng-template #tableBtns>
  <button
    routerLink="/sand-box/sand-account/digital/add"
    nz-button
    nzType="primary"
    class="m-r-8"
  >
    <i nz-icon nzType="plus"></i>
    {{ (isOverMode$ | async) ? 'Create' : 'Create a Binding' }}
  </button>
</ng-template>
